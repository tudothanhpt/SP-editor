import sys
import numpy as np
from PySide6 import QtCore, QtGui, QtWidgets
from matplotlib.backends.backend_qtagg import FigureCanvasQTAgg as FigureCanvas
from matplotlib.backends.backend_qtagg import NavigationToolbar2QT as NavigationToolbar
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d.art3d import Poly3DCollection
from matplotlib import cm
import seaborn as sns

sns.set()


class MyMainWindow(QtWidgets.QMainWindow):
    def __init__(self):
        super().__init__()
        self.setWindowTitle("3D Extruded Shape with Circles Example")
        self.setGeometry(100, 100, 800, 600)

        # Points data for the main shape
        points = np.array([
            [4600, 13125], [4600, 2250], [0, 2250], [0, 0], [13900, 0],
            [13900, 2250], [6600, 2250], [6600, 7625], [23300, 7625],
            [23300, 2250], [18000, 2250], [18000, 0], [29000, 0], [29000, 2250],
            [25300, 2250], [25300, 13125], [23300, 13125], [23300, 8625],
            [6600, 8625], [6600, 13125]
        ])

        # Circle points data
        diameter = 40
        point_circle = [(4650.0, 13075.0), (4650.0, 12824.9061913696), (4650.0, 12574.81238273921),
                        (4650.0, 12324.71857410882), (4650.0, 12074.62476547842), (4650.0, 11824.53095684803),
                        (4650.0, 11574.43714821763), (4650.0, 11324.34333958724), (4650.0, 11074.24953095685),
                        (4650.0, 10824.15572232645), (4650.0, 10574.06191369606), (4650.0, 10323.96810506566),
                        (4650.0, 10073.87429643527), (4650.0, 9823.780487804877), (4650.0, 9573.686679174483),
                        (4650.0, 9323.59287054409), (4650.0, 9073.499061913695), (4650.0, 8823.405253283301),
                        (4650.0, 8573.311444652905), (4650.0, 8323.217636022511), (4650.0, 8073.123827392121),
                        (4650.0, 7823.030018761726), (4650.0, 7572.936210131331), (4650.0, 7322.842401500939),
                        (4650.0, 7072.748592870545), (4650.0, 6822.65478424015), (4650.0, 6572.560975609757),
                        (4650.0, 6322.467166979364), (4650.0, 6072.373358348968), (4650.0, 5822.279549718574),
                        (4650.0, 5572.18574108818), (4650.0, 5322.091932457786), (4650.0, 5071.998123827392),
                        (4650.0, 4821.904315196999), (4650.0, 4571.810506566604), (4650.0, 4321.716697936209),
                        (4650.0, 4071.622889305816), (4650.0, 3821.529080675422), (4650.0, 3571.435272045028),
                        (4650.0, 3321.341463414634), (4650.0, 3071.24765478424), (4650.0, 2821.153846153846),
                        (4650.0, 2571.060037523452), (4650.0, 2320.966228893058), (4520.872420262663, 2200.0),
                        (4270.778611632269, 2200.0), (4020.684803001875, 2200.0), (3770.590994371481, 2200.0),
                        (3520.497185741089, 2200.0), (3270.403377110695, 2200.0), (3020.309568480301, 2200.0),
                        (2770.215759849907, 2200.0), (2520.121951219513, 2200.0), (2270.028142589119, 2200.0),
                        (2019.934333958725, 2200.0), (1769.840525328331, 2200.0), (1519.746716697937, 2200.0),
                        (1269.652908067542, 2200.0), (1019.559099437149, 2200.0), (769.4652908067546, 2200.0),
                        (519.3714821763605, 2200.0), (269.2776735459665, 2200.0), (50.0, 2169.183864915572),
                        (50.0, 1919.090056285178), (50.0, 1668.996247654784), (50.0, 1418.90243902439),
                        (50.0, 1168.808630393996), (50.0, 918.7148217636021), (50.0, 668.621013133208),
                        (50.0, 418.5272045028141), (50.0, 168.43339587242), (181.660412757974, 50.0),
                        (431.754221388368, 50.0), (681.848030018762, 50.0), (931.9418386491561, 50.0),
                        (1182.03564727955, 50.0), (1432.129455909944, 50.0), (1682.223264540338, 50.0),
                        (1932.317073170732, 50.0), (2182.410881801127, 50.0), (2432.504690431521, 50.0),
                        (2682.598499061914, 50.0), (2932.692307692309, 50.0), (3182.786116322703, 50.0),
                        (3432.879924953097, 50.0), (3682.973733583491, 50.0), (3933.067542213885, 50.0),
                        (4183.161350844279, 50.0), (4433.255159474673, 50.0), (4683.348968105067, 50.0),
                        (4933.442776735461, 50.0), (5183.536585365855, 50.0), (5433.630393996248, 50.0),
                        (5683.724202626643, 50.0), (5933.818011257037, 50.0), (6183.91181988743, 50.0),
                        (6434.005628517822, 50.0), (6684.099437148216, 50.0), (6934.19324577861, 50.0),
                        (7184.287054409003, 50.0), (7434.380863039398, 50.0), (7684.474671669791, 50.0),
                        (7934.568480300185, 50.0), (8184.66228893058, 50.0), (8434.756097560974, 50.0),
                        (8684.849906191368, 50.0), (8934.94371482176, 50.0), (9185.037523452156, 50.0),
                        (9435.13133208255, 50.0), (9685.225140712944, 50.0), (9935.31894934334, 50.0),
                        (10185.41275797373, 50.0), (10435.50656660412, 50.0), (10685.60037523452, 50.0),
                        (10935.69418386491, 50.0), (11185.78799249531, 50.0), (11435.8818011257, 50.0),
                        (11685.97560975609, 50.0), (11936.06941838649, 50.0), (12186.16322701688, 50.0),
                        (12436.25703564728, 50.0), (12686.35084427767, 50.0), (12936.44465290807, 50.0),
                        (13186.53846153846, 50.0), (13436.63227016885, 50.0), (13686.72607879924, 50.0),
                        (13850.0, 136.8198874296431), (13850.0, 386.9136960600372), (13850.0, 637.0075046904312),
                        (13850.0, 887.1013133208252), (13850.0, 1137.195121951219), (13850.0, 1387.288930581613),
                        (13850.0, 1637.382739212007), (13850.0, 1887.476547842402), (13850.0, 2137.570356472796),
                        (13662.33583489681, 2200.0), (13412.24202626641, 2200.0), (13162.14821763602, 2200.0),
                        (12912.05440900563, 2200.0), (12661.96060037523, 2200.0), (12411.86679174484, 2200.0),
                        (12161.77298311444, 2200.0), (11911.67917448405, 2200.0), (11661.58536585366, 2200.0),
                        (11411.49155722326, 2200.0), (11161.39774859287, 2200.0), (10911.30393996247, 2200.0),
                        (10661.21013133208, 2200.0), (10411.11632270169, 2200.0), (10161.02251407129, 2200.0),
                        (9910.9287054409, 2200.0), (9660.834896810506, 2200.0), (9410.741088180112, 2200.0),
                        (9160.64727954972, 2200.0), (8910.553470919323, 2200.0), (8660.459662288928, 2200.0),
                        (8410.365853658535, 2200.0), (8160.272045028142, 2200.0), (7910.178236397747, 2200.0),
                        (7660.084427767355, 2200.0), (7409.990619136959, 2200.0), (7159.896810506565, 2200.0),
                        (6909.803001876172, 2200.0), (6659.709193245778, 2200.0), (6550.0, 2340.384615384617),
                        (6550.0, 2590.478424015011), (6550.0, 2840.572232645405), (6550.0, 3090.666041275799),
                        (6550.0, 3340.759849906194), (6550.0, 3590.853658536588), (6550.0, 3840.947467166981),
                        (6550.0, 4091.041275797375), (6550.0, 4341.13508442777), (6550.0, 4591.228893058164),
                        (6550.0, 4841.322701688557), (6550.0, 5091.416510318952), (6550.0, 5341.510318949346),
                        (6550.0, 5591.604127579739), (6550.0, 5841.697936210134), (6550.0, 6091.791744840527),
                        (6550.0, 6341.885553470922), (6550.0, 6591.979362101316), (6550.0, 6842.07317073171),
                        (6550.0, 7092.166979362104), (6550.0, 7342.260787992498), (6550.0, 7592.354596622893),
                        (6717.448405253286, 7675.0), (6967.542213883681, 7675.0), (7217.636022514074, 7675.0),
                        (7467.729831144469, 7675.0), (7717.823639774862, 7675.0), (7967.917448405256, 7675.0),
                        (8218.011257035643, 7675.0), (8468.105065666037, 7675.0), (8718.198874296431, 7675.0),
                        (8968.292682926825, 7675.0), (9218.38649155722, 7675.0), (9468.480300187612, 7675.0),
                        (9718.57410881801, 7675.0), (9968.667917448402, 7675.0), (10218.76172607879, 7675.0),
                        (10468.85553470919, 7675.0), (10718.94934333958, 7675.0), (10969.04315196998, 7675.0),
                        (11219.13696060037, 7675.0), (11469.23076923076, 7675.0), (11719.32457786116, 7675.0),
                        (11969.41838649155, 7675.0), (12219.51219512195, 7675.0), (12469.60600375234, 7675.0),
                        (12719.69981238273, 7675.0), (12969.79362101313, 7675.0), (13219.88742964352, 7675.0),
                        (13469.98123827392, 7675.0), (13720.07504690431, 7675.0), (13970.16885553471, 7675.0),
                        (14220.2626641651, 7675.0), (14470.35647279549, 7675.0), (14720.45028142589, 7675.0),
                        (14970.54409005628, 7675.0), (15220.63789868667, 7675.0), (15470.73170731707, 7675.0),
                        (15720.82551594746, 7675.0), (15970.91932457786, 7675.0), (16221.01313320825, 7675.0),
                        (16471.10694183864, 7675.0), (16721.20075046904, 7675.0), (16971.29455909943, 7675.0),
                        (17221.38836772983, 7675.0), (17471.48217636022, 7675.0), (17721.57598499062, 7675.0),
                        (17971.66979362101, 7675.0), (18221.7636022514, 7675.0), (18471.8574108818, 7675.0),
                        (18721.95121951219, 7675.0), (18972.04502814259, 7675.0), (19222.13883677298, 7675.0),
                        (19472.23264540337, 7675.0), (19722.32645403377, 7675.0), (19972.42026266416, 7675.0),
                        (20222.51407129456, 7675.0), (20472.60787992495, 7675.0), (20722.70168855534, 7675.0),
                        (20972.79549718574, 7675.0), (21222.88930581613, 7675.0), (21472.98311444653, 7675.0),
                        (21723.07692307692, 7675.0), (21973.17073170732, 7675.0), (22223.26454033771, 7675.0),
                        (22473.3583489681, 7675.0), (22723.4521575985, 7675.0), (22973.54596622889, 7675.0),
                        (23223.63977485929, 7675.0), (23350.0, 7551.26641651032), (23350.0, 7301.172607879926),
                        (23350.0, 7051.078799249532), (23350.0, 6800.984990619138), (23350.0, 6550.891181988743),
                        (23350.0, 6300.797373358349), (23350.0, 6050.703564727956), (23350.0, 5800.609756097561),
                        (23350.0, 5550.515947467167), (23350.0, 5300.422138836773), (23350.0, 5050.328330206379),
                        (23350.0, 4800.234521575985), (23350.0, 4550.140712945591), (23350.0, 4300.046904315197),
                        (23350.0, 4049.953095684803), (23350.0, 3799.859287054409), (23350.0, 3549.765478424015),
                        (23350.0, 3299.671669793621), (23350.0, 3049.577861163227), (23350.0, 2799.484052532833),
                        (23350.0, 2549.390243902439), (23350.0, 2299.296435272045), (23199.20262664165, 2200.0),
                        (22949.10881801126, 2200.0), (22699.01500938086, 2200.0), (22448.92120075047, 2200.0),
                        (22198.82739212008, 2200.0), (21948.73358348968, 2200.0), (21698.63977485928, 2200.0),
                        (21448.54596622889, 2200.0), (21198.4521575985, 2200.0), (20948.35834896811, 2200.0),
                        (20698.26454033771, 2200.0), (20448.17073170732, 2200.0), (20198.07692307692, 2200.0),
                        (19947.98311444652, 2200.0), (19697.88930581613, 2200.0), (19447.79549718574, 2200.0),
                        (19197.70168855534, 2200.0), (18947.60787992495, 2200.0), (18697.51407129456, 2200.0),
                        (18447.42026266416, 2200.0), (18197.32645403377, 2200.0), (18050.0, 2097.232645403376),
                        (18050.0, 1847.138836772981), (18050.0, 1597.045028142587), (18050.0, 1346.951219512193),
                        (18050.0, 1096.857410881799), (18050.0, 846.7636022514052), (18050.0, 596.6697936210109),
                        (18050.0, 346.5759849906171), (18050.0, 96.4821763602231), (18253.61163227017, 50.0),
                        (18503.70544090056, 50.0), (18753.79924953096, 50.0), (19003.89305816135, 50.0),
                        (19253.98686679175, 50.0), (19504.08067542214, 50.0), (19754.17448405253, 50.0),
                        (20004.26829268293, 50.0), (20254.36210131332, 50.0), (20504.45590994372, 50.0),
                        (20754.54971857411, 50.0), (21004.64352720451, 50.0), (21254.7373358349, 50.0),
                        (21504.83114446529, 50.0), (21754.92495309569, 50.0), (22005.01876172608, 50.0),
                        (22255.11257035648, 50.0), (22505.20637898687, 50.0), (22755.30018761727, 50.0),
                        (23005.39399624766, 50.0), (23255.48780487805, 50.0), (23505.58161350845, 50.0),
                        (23755.67542213884, 50.0), (24005.76923076923, 50.0), (24255.86303939963, 50.0),
                        (24505.95684803002, 50.0), (24756.05065666042, 50.0), (25006.14446529081, 50.0),
                        (25256.2382739212, 50.0), (25506.3320825516, 50.0), (25756.42589118199, 50.0),
                        (26006.51969981239, 50.0), (26256.61350844278, 50.0), (26506.70731707318, 50.0),
                        (26756.80112570357, 50.0), (27006.89493433396, 50.0), (27256.98874296436, 50.0),
                        (27507.08255159475, 50.0), (27757.17636022514, 50.0), (28007.27016885554, 50.0),
                        (28257.36397748594, 50.0), (28507.45778611633, 50.0), (28757.55159474672, 50.0),
                        (28950.0, 107.6454033771151), (28950.0, 357.7392120075093), (28950.0, 607.8330206379032),
                        (28950.0, 857.9268292682973), (28950.0, 1108.020637898691), (28950.0, 1358.114446529085),
                        (28950.0, 1608.208255159479), (28950.0, 1858.302063789873), (28950.0, 2108.395872420268),
                        (28791.51031894934, 2200.0), (28541.41651031894, 2200.0), (28291.32270168855, 2200.0),
                        (28041.22889305816, 2200.0), (27791.13508442776, 2200.0), (27541.04127579737, 2200.0),
                        (27290.94746716698, 2200.0), (27040.85365853658, 2200.0), (26790.75984990619, 2200.0),
                        (26540.66604127579, 2200.0), (26290.5722326454, 2200.0), (26040.47842401501, 2200.0),
                        (25790.38461538461, 2200.0), (25540.29080675422, 2200.0), (25290.19699812382, 2200.0),
                        (25250.0, 2409.896810506572), (25250.0, 2659.990619136967), (25250.0, 2910.08442776736),
                        (25250.0, 3160.178236397755), (25250.0, 3410.272045028149), (25250.0, 3660.365853658543),
                        (25250.0, 3910.459662288937), (25250.0, 4160.553470919331), (25250.0, 4410.647279549724),
                        (25250.0, 4660.741088180119), (25250.0, 4910.834896810513), (25250.0, 5160.928705440907),
                        (25250.0, 5411.022514071287), (25250.0, 5661.11632270168), (25250.0, 5911.210131332075),
                        (25250.0, 6161.303939962468), (25250.0, 6411.397748592865), (25250.0, 6661.491557223257),
                        (25250.0, 6911.585365853652), (25250.0, 7161.679174484046), (25250.0, 7411.77298311444),
                        (25250.0, 7661.866791744833), (25250.0, 7911.960600375228), (25250.0, 8162.054409005621),
                        (25250.0, 8412.148217636017), (25250.0, 8662.24202626641), (25250.0, 8912.335834896803),
                        (25250.0, 9162.429643527197), (25250.0, 9412.523452157591), (25250.0, 9662.617260787989),
                        (25250.0, 9912.71106941838), (25250.0, 10162.80487804877), (25250.0, 10412.89868667917),
                        (25250.0, 10662.99249530956), (25250.0, 10913.08630393996), (25250.0, 11163.18011257035),
                        (25250.0, 11413.27392120074), (25250.0, 11663.36772983114), (25250.0, 11913.46153846153),
                        (25250.0, 12163.55534709192), (25250.0, 12413.64915572232), (25250.0, 12663.74296435271),
                        (25250.0, 12913.83677298311), (25161.0694183865, 13075.0), (24910.9756097561, 13075.0),
                        (24660.88180112571, 13075.0), (24410.78799249531, 13075.0), (24160.69418386492, 13075.0),
                        (23910.60037523453, 13075.0), (23660.50656660414, 13075.0), (23410.41275797374, 13075.0),
                        (23350.0, 12885.31894934334), (23350.0, 12635.22514071295), (23350.0, 12385.13133208255),
                        (23350.0, 12135.03752345216), (23350.0, 11884.94371482177), (23350.0, 11634.84990619137),
                        (23350.0, 11384.75609756098), (23350.0, 11134.66228893059), (23350.0, 10884.56848030019),
                        (23350.0, 10634.4746716698), (23350.0, 10384.3808630394), (23350.0, 10134.28705440901),
                        (23350.0, 9884.193245778619), (23350.0, 9634.099437148221), (23350.0, 9384.005628517829),
                        (23350.0, 9133.911819887435), (23350.0, 8883.81801125704), (23350.0, 8633.724202626647),
                        (23158.63039399626, 8575.0), (22908.53658536586, 8575.0), (22658.44277673546, 8575.0),
                        (22408.34896810507, 8575.0), (22158.25515947468, 8575.0), (21908.16135084428, 8575.0),
                        (21658.06754221389, 8575.0), (21407.9737335835, 8575.0), (21157.8799249531, 8575.0),
                        (20907.78611632271, 8575.0), (20657.69230769231, 8575.0), (20407.59849906192, 8575.0),
                        (20157.50469043152, 8575.0), (19907.41088180113, 8575.0), (19657.31707317073, 8575.0),
                        (19407.22326454034, 8575.0), (19157.12945590995, 8575.0), (18907.03564727955, 8575.0),
                        (18656.94183864916, 8575.0), (18406.84803001876, 8575.0), (18156.75422138837, 8575.0),
                        (17906.66041275797, 8575.0), (17656.56660412758, 8575.0), (17406.47279549719, 8575.0),
                        (17156.37898686679, 8575.0), (16906.2851782364, 8575.0), (16656.19136960601, 8575.0),
                        (16406.09756097561, 8575.0), (16156.00375234522, 8575.0), (15905.90994371482, 8575.0),
                        (15655.81613508443, 8575.0), (15405.72232645404, 8575.0), (15155.62851782364, 8575.0),
                        (14905.53470919325, 8575.0), (14655.44090056285, 8575.0), (14405.34709193246, 8575.0),
                        (14155.25328330206, 8575.0), (13905.15947467167, 8575.0), (13655.06566604128, 8575.0),
                        (13404.97185741088, 8575.0), (13154.87804878049, 8575.0), (12904.7842401501, 8575.0),
                        (12654.6904315197, 8575.0), (12404.59662288931, 8575.0), (12154.50281425891, 8575.0),
                        (11904.40900562852, 8575.0), (11654.31519699812, 8575.0), (11404.22138836773, 8575.0),
                        (11154.12757973734, 8575.0), (10904.03377110694, 8575.0), (10653.93996247655, 8575.0),
                        (10403.84615384615, 8575.0), (10153.75234521576, 8575.0), (9903.658536585368, 8575.0),
                        (9653.564727954972, 8575.0), (9403.470919324582, 8575.0), (9153.377110694186, 8575.0),
                        (8903.283302063792, 8575.0), (8653.189493433398, 8575.0), (8403.095684803004, 8575.0),
                        (8153.001876172609, 8575.0), (7902.908067542215, 8575.0), (7652.814258911821, 8575.0),
                        (7402.720450281427, 8575.0), (7152.626641651034, 8575.0), (6902.532833020639, 8575.0),
                        (6652.439024390246, 8575.0), (6550.0, 8722.654784240149), (6550.0, 8972.748592870543),
                        (6550.0, 9222.842401500937), (6550.0, 9472.93621013133), (6550.0, 9723.030018761727),
                        (6550.0, 9973.12382739212), (6550.0, 10223.21763602251), (6550.0, 10473.31144465291),
                        (6550.0, 10723.4052532833), (6550.0, 10973.49906191369), (6550.0, 11223.59287054409),
                        (6550.0, 11473.68667917448), (6550.0, 11723.78048780488), (6550.0, 11973.87429643527),
                        (6550.0, 12223.96810506566), (6550.0, 12474.06191369606), (6550.0, 12724.15572232645),
                        (6550.0, 12974.24953095684), (6400.656660412758, 13075.0), (6150.562851782364, 13075.0),
                        (5900.469043151971, 13075.0), (5650.375234521576, 13075.0), (5400.281425891183, 13075.0),
                        (5150.187617260788, 13075.0), (4900.093808630394, 13075.0)]  # Example circle centers

        # Create a Matplotlib figure and 3D subplot
        fig = plt.figure(figsize=(8, 6))
        ax = fig.add_subplot(111, projection='3d')

        # Define the height of the extrusion
        height = 5000  # 5 meters in mm

        # Define a blue color palette
        colors = cm.Blues(np.linspace(0.2, 1, len(points)))

        # Create closed polyline by connecting the points and extruding
        for i in range(len(points) - 1):
            x = [points[i][0], points[i + 1][0], points[i + 1][0], points[i][0], points[i][0]]
            y = [points[i][1], points[i + 1][1], points[i + 1][1], points[i][1], points[i][1]]
            z = [0, 0, height, height, 0]
            verts = [list(zip(x, y, z))]
            pc = Poly3DCollection(verts, facecolors=colors[i], edgecolors='black')
            ax.add_collection3d(pc)

        # Connect the last point to the first to close the polyline
        x = [points[-1][0], points[0][0], points[0][0], points[-1][0], points[-1][0]]
        y = [points[-1][1], points[0][1], points[0][1], points[-1][1], points[-1][1]]
        z = [0, 0, height, height, 0]
        verts = [list(zip(x, y, z))]
        pc = Poly3DCollection(verts, facecolors=colors[-1], edgecolors='black')
        ax.add_collection3d(pc)

        # Plot circles as 3D solids
        for center in point_circle:
            x_circle = center[0]
            y_circle = center[1]
            z_circle = np.linspace(0, height, 100)
            theta = np.linspace(0, 2 * np.pi, 100)
            r = diameter / 2
            x = r * np.outer(np.cos(theta), np.ones_like(z_circle)) + x_circle
            y = r * np.outer(np.sin(theta), np.ones_like(z_circle)) + y_circle
            z = np.outer(np.ones_like(theta), z_circle)
            ax.plot_surface(x, y, z, color='red', alpha=0.5)

        ax.set_xlabel('X (mm)')
        ax.set_ylabel('Y (mm)')
        ax.set_zlabel('Z (mm)')

        # Extend limits by 2000 mm in x and y directions
        ax.set_xlim(-2000, 30000 + 2000)
        ax.set_ylim(-2000, 15000 + 2000)
        ax.set_zlim(0, height)

        # Create a canvas to display the figure
        self.canvas = FigureCanvas(fig)

        # Create a navigation toolbar with pan and zoom enabled
        self.toolbar = NavigationToolbar(self.canvas, self)
        self.toolbar.setToolButtonStyle(QtCore.Qt.ToolButtonTextBesideIcon)  # Optional: Show text beside icons

        # Create a QFrame to hold canvas and toolbar
        frame = QtWidgets.QFrame()
        frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        frame.setFrameShadow(QtWidgets.QFrame.Raised)

        # Create a layout for the QFrame
        frame_layout = QtWidgets.QVBoxLayout(frame)
        frame_layout.addWidget(self.toolbar)
        frame_layout.addWidget(self.canvas)

        # Set the layout to stretch the canvas
        frame_layout.setContentsMargins(0, 0, 0, 0)
        frame_layout.setSpacing(0)
        frame.setLayout(frame_layout)

        # Set the central widget to the QFrame
        self.setCentralWidget(frame)


if __name__ == "__main__":
    app = QtWidgets.QApplication([])
    window = MyMainWindow()
    window.show()
    sys.exit(app.exec())
